# Phase 2: 게임플레이 구현 (3주)

**목표**: 스킬 시스템, 몬스터 AI, 맵 시스템, 게임 진행 로직 완성

**기간**: 주차 4-6

---

## 체크리스트

### 2.1 스킬 시스템 (✅ 완료)

#### 기본 구조
- [x] Skill 추상 클래스 구현
- [x] SkillManager 클래스 구현
- [x] 쿨다운 시스템

#### 불 원소 스킬
- [x] 화염구 (Fireball)
- [x] 화염 폭발 (Explosion) - AoE 버그 수정
- [x] 용암 분출 (Lava Burst)

#### 물 원소 스킬
- [x] 얼음창 (Icicle)
- [x] 물줄기 (Water Stream)
- [x] 치유의 물 (Healing Water)

#### 바람 원소 스킬
- [x] 회오리 (Tornado)
- [x] 순간이동 (Blink)
- [x] 바람 칼날 (Wind Blade)

#### 땅 원소 스킬
- [x] 돌덩이 (Rock Throw)
- [x] 방어막 (Stone Shield)
- [x] 지진 (Earthquake)

#### 전기 원소 스킬
- [x] 번개 (Lightning Bolt)
- [x] 전기 충격 (Shock)
- [x] 체인 라이트닝 (Chain Lightning)

#### 투사체 및 충돌
- [x] Projectile 클래스 구현
- [x] 단일 표적 충돌 감지
- [x] 광역 충돌 감지 (Circle)
- [x] ProjectilePool (Object Pooling)

#### UI 통합
- [x] 스킬 버튼 렌더링 (4개)
- [x] 쿨다운 시각화 (원형 프로그레스)
- [x] MP 소비 표시

**담당**: 신은성

**완료**: 2025-10-25

**주요 수정**:
- 네트워크 동기화 완성: SkillCastMsg에 6개 필드 추가
- AoE 스킬 위치 버그: projectileSpeed==0 판별로 타겟 위치에서 생성
- 레벨 기반 스킬 언락 추가

---

### 2.2 몬스터 AI 시스템 (🔄 진행 예정)

#### 기본 구조
- [ ] Monster 추상 클래스
- [ ] MonsterSpawner 시스템

#### 몬스터 타입
- [ ] 마법 골렘 (근접 공격)
- [ ] 팬텀 북 (원거리, 텔레포트)
- [ ] 수정 거미 (웹 트랩, DoT)

#### AI 로직
- [ ] 상태 머신 (IDLE, PATROL, PURSUING, ATTACKING)
- [ ] 시야 범위 감지 (200px)
- [ ] 경로 찾기 (간단한 A*)
- [ ] 공격 패턴

#### 네트워킹
- [ ] 몬스터 위치 동기화
- [ ] 공격 이벤트 동기화
- [ ] 몬스터 제거 알림

**담당**: 신은성

**목표 완료**: 주차 5

---

### 2.3 충돌 및 피해 시스템 (🔄 진행 예정)

- [ ] 플레이어-몬스터 충돌
- [ ] 투사체-플레이어 충돌
- [ ] 투사체-몬스터 충돌
- [ ] 넉백 효과
- [ ] 피해 계산 공식
  - `damage = baseDamage × (1 + (공격력 - 방어력) / 100)`
- [ ] DoT (지속 피해) 관리
- [ ] 방어 상태 이상 (버프/디버프)

**담당**: 신은성, 김동연 (서버 검증)

**목표 완료**: 주차 5

---

### 2.4 던전 축소 메커니즘 (🔄 진행 예정)

#### 게임 페이즈
- [ ] Phase 0 (0-3분): 전체 맵 사용 가능
- [ ] Phase 1 (3-6분): 외곽 축소, 초당 5 데미지
- [ ] Phase 2 (6-8분): 중간까지 축소, 초당 10 데미지
- [ ] Phase 3 (8-10분): 중앙만 남음, 초당 20 데미지

#### 시각 효과
- [ ] 축소 구역 표시 (ShapeRenderer 원)
- [ ] 독가스 시각화 (반투명 레이어)
- [ ] 카운트다운 경고 (텍스트 알림)

#### 로직
- [ ] ShrinkingZoneManager 클래스
- [ ] 맵 경계 충돌
- [ ] 피해 적용

**담당**: 신은성

**목표 완료**: 주차 4

---

### 2.5 레벨업 및 경험치 시스템 (🔄 진행 예정)

- [ ] 경험치 획득 이벤트
  - 몬스터 처치: 10-30 EXP
  - 플레이어 처치: 50 EXP
  - 생존 보너스: 순위 × 100 EXP

- [ ] 레벨업 로직
  - 필요 경험치 = 레벨 × 100
  - 레벨 상한: 20

- [ ] 스탯 증가
  - HP +20
  - MP +15
  - 공격력 +5%

- [ ] UI 표시
  - 레벨 표시
  - 경험치 바
  - 레벨업 알림

**담당**: 신은성

**목표 완료**: 주차 5

---

### 2.6 맵 시스템 (🔄 진행 예정)

#### TiledMap 기반
- [ ] Tiled Map Editor로 맵 디자인
- [ ] tileset.tsx 작성
- [ ] map_01.tmx 저장

#### 레이어
- [ ] Background: 바닥 타일
- [ ] Collision: 장애물 표시
- [ ] Objects: 스폰 포인트
- [ ] Effects: 축소 구역 표시

#### 로드 및 렌더링
- [ ] MapRenderer 클래스
- [ ] TiledMap 로드
- [ ] 카메라 설정
- [ ] 타일 기반 충돌 감지

#### 아이템 시스템
- [ ] ItemSpawner 클래스
- [ ] 아이템 타입 (포션, 스킬북, 에센스)
- [ ] 아이템 획득 로직
- [ ] 아이템 렌더링

**담당**: 김태희 (그래픽), 신은성 (로직)

**목표 완료**: 주차 6

---

### 2.7 게임 타이머 및 UI (🔄 진행 예정)

- [ ] 게임 타이머 표시 (MM:SS)
- [ ] HP/MP 바 렌더링
- [ ] 스킬 버튼 (4개)
- [ ] 미니맵 (축소된 맵)
- [ ] 플레이어 순위 표시
- [ ] 데미지 텍스트 (떠오르는 텍스트)

**담당**: 신은성

**목표 완료**: 주차 5

---

## 요구사항 분석

### 기술 요구사항
- @docs/spec/skills-system.md 참고
- @docs/spec/monsters-ai.md 참고
- @docs/spec/map-system.md 참고

### 성능 요구사항
- 몬스터 최대 50개 동시 렌더링
- 투사체 최대 100개 동시 관리
- 타일맵 60×60 타일 최적화 렌더링
- 초당 50FPS 이상 유지

---

## 위험 요소 및 해결책

| 위험 요소 | 영향 | 대처 방안 |
|----------|------|----------|
| 네트워크 동기화 지연 | 높음 | 클라이언트 예측, 보간 적용 |
| 몬스터 AI 성능 저하 | 중간 | AI 업데이트 빈도 감소, 거리 기반 활성화 |
| 타일맵 렌더링 느림 | 중간 | 동적 로드/언로드, 가시 범위 최적화 |
| 메모리 누수 | 중간 | Object Pooling, 적절한 dispose 관리 |

---

## 테스트 계획

### 유닛 테스트
- 스킬 피해 계산
- 몬스터 AI 경로 찾기
- 충돌 감지 알고리즘

### 통합 테스트
- 멀티플레이 스킬 동기화
- 몬스터-플레이어 상호작용
- 네트워크 패킷 손실 시뮬레이션

### 플레이 테스트
- 게임 밸런스 (난이도)
- UI/UX 개선 사항
- 성능 병목 지점

---

## 진행 상황 요약

**상태**: 🔄 **진행 중** (45% 완료)

### 2025-10-25 업데이트
- ✅ **스킬 시스템**: 100% 완료
  - 15개 스킬 모두 구현 및 네트워크 동기화
  - AoE 스킬 위치 버그 완벽 수정
  - 레벨별 스킬 언락 시스템 추가
  - 캐릭터 이동 속도 개선

- ✅ **레벨 시스템**: 100% 완료
  - 레벨 1~5 진행
  - 레벨별 스킬 언락 (1/2/3개)
  - 디버그 키 (K/L) 추가

- ✅ **원소 변경**: 100% 완료
  - 1-5 키로 원소 즉시 변경
  - 스킬 버튼 동시 업데이트

### 다음 작업
Phase 2의 나머지 항목들:
- 🔄 몬스터 AI 시스템
- 🔄 게임 맵 및 축소 메커니즘
- 🔄 충돌 감지 및 피해 계산

**다음 단계**: 몬스터 AI 구현 후 Phase 3로 진행
